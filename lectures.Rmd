---
title: "Lectures"
---


```{r include = FALSE}
library(dplyr)
library(stringr)
library(httr)
```



```{r include = FALSE}
# Import schedule
rawdat <- read.csv(file.path("course-admin", "schedule_2023.csv"), stringsAsFactors = FALSE, colClasses = list(course = 'factor', dow = 'factor'))
rawdat$course <- as.factor(rawdat$course)

# Class meetings
rawdat_cm <- rawdat[rawdat$course == "STAT540",]

cdat <- rawdat_cm %>%
  mutate(ugly_date = ISOdate(2023, match(month, month.name), day),
         date = sprintf("%s %s %d",
                        dow, months(ugly_date, abbreviate = TRUE),
                        day),
         notes = ifelse(grepl("^lect", lect) & raw_notes != "",
                        sprintf("%s: %s", lect, raw_notes), raw_notes))
cdat %>% head(3)


## link to the class page of any class meetings where such exists
req <- GET("https://api.github.com/repos/STAT540-UBC/lectures/git/trees/main?recursive=1")
stop_for_status(req)
filelist <- unlist(lapply(content(req)$tree, "[", "path"), use.names = F)

# now grab pdf & html file names
cmdat <-
  data.frame(file = filelist[grepl('^lect.*pdf|^lect.*html', basename(filelist))],
             stringsAsFactors = FALSE)

cmdat <- cmdat %>% mutate(lect = str_extract(file, "lect[0-9]+"))
cmdat$lect <- sapply(cmdat$lect, str_replace, pattern="lect0*([0-9]+)", replacement="lecture-\\1")

if (nrow(cmdat) >0){
  cdat <- cdat %>% left_join(cmdat, by="lect")
}else{
  cdat$file <- NA
}

pdf_exists <- grepl("*.pdf", cdat$file)
html_exists <- grepl("*.html", cdat$file)
file_exists <- Negate(is.na)(cdat$file)

# Insert placeholder link to notes 
#cdat$notes[pdf_exists] <-
 # str_replace(cdat$notes[which(pdf_exists)],
#              "(lecture-[0-9]+)|(lecture-[1-9]+)", '<a href="LINK">\\1</a>')
cdat$notes <- gsub("lecture-", "Lecture ", cdat$notes)

cdat$notes[file_exists] <-
  str_replace(cdat$notes[which(file_exists)],
              "(Lecture [0-9]+)|(Lecture [1-9]+)", '[\\1](LINK)')
# Replace placeholder "LINK" with pdf file names
if (sum(pdf_exists) > 0)
  cdat$notes[pdf_exists] <- str_replace(cdat$notes[which(pdf_exists)], "LINK", paste0("https://github.com/STAT540-UBC/lectures/raw/main/", cdat$file[which(pdf_exists)]))

# Replace placeholder "LINK" with html file names
if (sum(html_exists) > 0)
  cdat$notes[html_exists] <- str_replace(cdat$notes[which(html_exists)], "LINK", paste0("https://stat540-ubc.github.io/lectures/", cdat$file[which(html_exists)]))

dat_cm <- cdat %>% split(cdat$course)
dat_cm <- lapply(dat_cm, 'rownames<-', NULL)
```



### Class meetings and schedule 

**Time** : Tues Thurs 9:00 - 10:30am

**Location**: Frank Forward 317

**Supplemental Files**: 

* Additional companion notes can be found in the [STAT540-UBC/resources GitHub repo](https://github.com/STAT540-UBC/resources)
* Source files for lectures can be found the [STAT540-UBC/lectures GitHub repo](https://github.com/STAT540-UBC/lectures)

```{r results = 'asis', echo = FALSE}
# add readings
sched <- dat_cm[["STAT540"]] %>%
  mutate(readings = "") %>%
  select(date, readings, notes, instructor)

# lect 4
sched$readings[4] <- "
[1](http://genomicsclass.github.io/book/pages/populations_and_samples.html), 
[2](http://genomicsclass.github.io/book/pages/random_variables.html), 
[3](http://genomicsclass.github.io/book/pages/clt_and_t-distribution.html)
"

# print final table
knitr::kable(sched %>% 
  dplyr::rename(Date=date, "Pre-reading"=readings, Topic=notes, Instructor=instructor),
  "html", escape = FALSE) %>% 
  kableExtra::column_spec(1, width = "6em") %>%
  kableExtra::kable_styling(full_width = TRUE)
```

